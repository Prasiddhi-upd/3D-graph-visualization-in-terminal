<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2D Fizzbuzz Visualization</title>
  <style>
      body { margin: 0; }
      #graph { width: 100%; height: 100vh; }
    </style>
  <!-- Include Viz.js (instead of using graphlib) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/viz.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/full.render.js"></script>
</head>
<body>
  <div id="graph"></div>

  <script>
    // Simulated content of the DOT file
    const dotContent = `
      digraph PRODUCT {
        __SystemOverview [shape=box, label="This graph represents a FizzBuzz processing system for an educational video.\\nActors produce numbers divisible by 3 and 5.\\nA processor combines them into FizzBuzz messages.\\nA console printer outputs summary statistics every 10 seconds.\\nAn ErrorLogger captures any processing errors."];

        DivBy3Producer [label="Produces numbers divisible by 3\\nmod::div_by_3_producer\\nAtLeastEvery(1ms)"];
        DivBy5Producer [label="Produces numbers divisible by 5\\nmod::div_by_5_producer\\nAtLeastEvery(1ms)"];
        FizzBuzzProcessor [label="Generates Fizz, Buzz, and FizzBuzz records\\nmod::fizz_buzz_processor\\nOnEvent(numbers:1)"];
        ConsolePrinter [label="Prints summary counts to console\\nmod::console_printer\\nOnEvent(print_signal:1)"];
        TimerActor [label="Triggers printing every 10 seconds\\nmod::timer_actor\\nAtLeastEvery(10sec)"];
        ErrorLogger [label="Logs processing errors\\nmod::error_logger\\nOnEvent(errors:1)"];

        DivBy3Producer -> FizzBuzzProcessor [label="name::numbers <NumberMessage> >>TakeCopy #1000"];
        DivBy5Producer -> FizzBuzzProcessor [label="name::numbers <NumberMessage> >>TakeCopy #1000"];
        FizzBuzzProcessor -> ConsolePrinter [label="name::fizzbuzz_messages <FizzBuzzMessage> >>Take #10000"];
        TimerActor -> ConsolePrinter [label="name::print_signal <PrintSignal> >>Take #1"];
        FizzBuzzProcessor -> ErrorLogger [label="name::errors <ErrorMessage> >>Take #100"];

        __NumberMessage [shape=box, label="NumberMessage is a union type for numbers from DivBy3Producer and DivBy5Producer.\\nVariants: DivBy3Number, DivBy5Number."];
        __NumberMessage -> DivBy3Producer [style=dotted];
        __NumberMessage -> DivBy5Producer [style=dotted];
        __NumberMessage -> FizzBuzzProcessor [style=dotted];

        __FizzBuzzMessage [shape=box, label="FizzBuzzMessage contains 'Fizz', 'Buzz', or 'FizzBuzz' records.\\nGenerated by FizzBuzzProcessor for ConsolePrinter."];
        __FizzBuzzMessage -> FizzBuzzProcessor [style=dotted];
        __FizzBuzzMessage -> ConsolePrinter [style=dotted];

        __ErrorMessage [shape=box, label="ErrorMessage captures any errors during processing.\\nUsed by FizzBuzzProcessor to send to ErrorLogger."];
        __ErrorMessage -> FizzBuzzProcessor [style=dotted];
        __ErrorMessage -> ErrorLogger [style=dotted];
      }
    `;

    // Render the DOT content using Viz.js
    document.addEventListener('DOMContentLoaded', function () {
      const viz = new Viz();

      viz.renderSVGElement(dotContent)
        .then(element => {
          // Append the rendered SVG to the graph container
          document.getElementById('graph').appendChild(element);
        })
        .catch(error => {
          console.error('Error rendering DOT file:', error);
        });
    });
  </script>
</body>
